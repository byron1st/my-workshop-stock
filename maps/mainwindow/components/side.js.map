{"version":3,"sources":["mainwindow/components/side.jsx"],"names":["productActions","util","Side","$","sortable","handle","disableSelection","props","text","_openNewProductModal","isValidNameForProduct","_getProductListView","productSet","productOrder","map","product","id","itemContentView","editable","name","arg","productId","val","dispatch","SAVE_PRODUCT_NAME","TOGGLE_PRODUCT_EDITABLE","REMOVE_PRODUCT","getCurrencyValue","amount","modal","propTypes","object","isRequired","array","bool","NewProductModal","closable","removeClass","addClass","_checkName","_addNewProduct","ADD_NEWPRODUCT","e","ISVALIDNAME_FOR_PRODUCT","target","value"],"mappings":"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","file":"../../../src/mainwindow/components/side.js","sourcesContent":["/*global $*/\n'use strict'\n\nimport React, {Component, PropTypes} from 'react'\n\nimport dispatcher from '../../util/flux/dispatcher'\nimport * as productActions from '../flux/actions.product'\nimport * as util from '../../util/util'\n\nexport default class Side extends Component {\n  componentDidMount () {\n    $('#product-list').sortable({\n      handle: '.product-move-handle'\n    })\n    $('#product-list').disableSelection()\n  }\n  render () {\n    return (\n      <div className='ui visible right sidebar inverted vertical menu'>\n        <div className='ui segment inverted'>\n          <div className='ui center aligned large header inverted'>{this.props.text['Stock']}</div>\n          <button className='ui fluid compact blue button' onClick={this._openNewProductModal}>{this.props.text['Add a New Product']}</button>\n          <NewProductModal isValidNameForProduct={this.props.isValidNameForProduct} text={this.props.text}/>\n        </div>\n        <div className='ui segment inverted'>\n          <div className='ui relaxed middle aligned divided inverted list' id='product-list'>\n            {this._getProductListView(this.props.productSet, this.props.productOrder, this.props.text)}\n          </div>\n        </div>\n      </div>\n    )\n  }\n  _getProductListView (productSet, productOrder, text) {\n    return productOrder.map(id => {\n      let product = productSet[id]\n      let itemContentView\n      if (product.editable) {\n        itemContentView = <div className='product'>\n          <i className='move icon product-move-handle'></i>\n          <div className='ui inverted action small input'>\n            <input type='text' defaultValue={product.name} id={'input' + product.id}/>\n            <div className='ui icon button' onClick={() => {\n              let arg = {\n                productId: product.id,\n                name: $('#input' + product.id).val(),\n                productOrder: $('#product-list').sortable('toArray'),\n                text: text\n              }\n              dispatcher.dispatch(productActions.SAVE_PRODUCT_NAME, arg)\n            }}><i className='checkmark icon'></i></div>\n          </div>\n        </div>\n        \n      } else {\n        itemContentView = <div className='product'>\n          <a href='#' onClick={() => {\n            let arg = { productId: product.id, editable: true }\n            dispatcher.dispatch(productActions.TOGGLE_PRODUCT_EDITABLE, arg)\n          }}><i className='edit icon'></i></a> {product.name}\n          <a href='#' onClick={() => {\n            dispatcher.dispatch(productActions.REMOVE_PRODUCT, {productId: product.id, text: text})\n          }}><i className='ui right floated remove icon'></i></a>\n        </div>\n      }\n      return (<div className='item' key={product.id} id={product.id}>\n                <div className='middle aligned content'>\n                  {itemContentView}\n                </div>\n                <div className='extra'>\n                   <span>{util.getCurrencyValue(product.amount)}</span>\n                </div>\n              </div>)\n    })\n  }\n  _openNewProductModal () {\n    $('#newProductModal').modal('show')\n    $('#newProductName').val('')\n  }\n}\nSide.propTypes = {\n  productSet: PropTypes.object.isRequired,\n  productOrder: PropTypes.array.isRequired,\n  isValidNameForProduct: PropTypes.bool.isRequired,\n  text: PropTypes.object.isRequired\n}\n\nclass NewProductModal extends Component {\n  componentDidMount () {\n    $('#newProductModal').modal({\n      closable: false\n    })\n  }\n  componentDidUpdate () {\n    if (this.props.isValidNameForProduct) {\n      $('#modalNameForm').removeClass('error')\n      $('#modalCreateBtn').removeClass('disabled')\n    } else {\n      $('#modalNameForm').addClass('error')\n      $('#modalCreateBtn').addClass('disabled')\n    }\n  }\n  render () {\n    return (\n      <div className='ui small modal' id='newProductModal'>\n        <div className='header'>{this.props.text['Add a New Product']}</div>\n        <div className='content'>\n          <div className='ui form' id='modalNameForm'>\n            <div className='field'>\n              <label>{this.props.text['Name']}</label>\n              <input type='text' id='newProductName' onChange={this._checkName}/>\n            </div>\n            <div className='ui error message'>\n              <div className='header'>{this.props.text['Duplicated Name']}</div>\n              <p>{this.props.text['There is the same name in the list.']}</p>\n            </div>\n          </div>\n        </div>\n        <div className='actions'>\n          <div className='ui approve primary button' onClick={this._addNewProduct} id='modalCreateBtn'>{this.props.text['Create']}</div>\n          <div className='ui cancel button'>{this.props.text['Cancel']}</div>\n        </div>\n      </div>\n    )\n  }\n  _addNewProduct () {\n    dispatcher.dispatch(productActions.ADD_NEWPRODUCT, { name: $('#newProductName').val() })\n  }\n  _checkName (e) {\n    dispatcher.dispatch(productActions.ISVALIDNAME_FOR_PRODUCT, e.target.value)\n  }\n}\nNewProductModal.propTypes = {\n  isValidNameForProduct: PropTypes.bool.isRequired,\n  text: PropTypes.object.isRequired\n}"]}